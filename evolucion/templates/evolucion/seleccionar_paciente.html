{% extends "base/base.html" %}

{% block title %}Seleccionar Paciente - Nueva Evoluci贸n{% endblock %}

{% block page_content %}
<div class="container-fluid mt-4">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-md-8">
            <h1 class="h2"> Nueva Evoluci贸n</h1>
            <p class="text-muted">Selecciona un paciente para crear una nueva evoluci贸n</p>
        </div>
        <div class="col-md-4 text-right">
            <a href="{% url 'evolucion:lista' %}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Volver
            </a>
        </div>
    </div>

    <!-- Selecci贸n de Paciente -->
    <div class="card">
        <div class="card-header">
            <i class="fas fa-user-medical"></i> Pacientes Disponibles
        </div>
        <div class="card-body">
            {% if pacientes %}
            <form method="POST">
                {% csrf_token %}
                <div class="form-group">
                    <label for="pacienteSelect">Selecciona un paciente:</label>
                    <select class="form-control select2" id="pacienteSelect" name="paciente_id" required style="width: 100%;">
                        <option value="">-- Elige un paciente --</option>
                        {% for paciente in pacientes %}
                        <option value="{{ paciente.id }}">
                            {{ paciente.nombres }} {% if paciente.apellidos %}{{ paciente.apellidos }}{% endif %}
                            - {{ paciente.cedula }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-chevron-right"></i> Continuar
                    </button>
                    <a href="{% url 'evolucion:lista' %}" class="btn btn-secondary">
                        Cancelar
                    </a>
                </div>
            </form>
            {% else %}
            <div class="alert alert-warning">
                <i class="fas fa-exclamation-triangle"></i> No hay pacientes registrados en esta cl铆nica.
                <a href="{% url 'pacientes:crear' %}" class="alert-link">Crear paciente</a>
            </div>
            {% endif %}
        </div>
    </div>
</div>

{% block extra_js %}
<script>
$(document).ready(function() {
    // Initialize Select2
    $('#pacienteSelect').select2({
        theme: "bootstrap",
        language: "es",
        placeholder: "Busca y selecciona un paciente",
        allowClear: true,
        width: '100%'
    });
});
</script>
{% endblock %}
{% endblock %}
